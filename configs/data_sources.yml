# Data sources configuration
# Declare upstream vendors, auth, and canonical reconciliation behavior.
raw_shard_yearly_daily: false
vendors:
  - name: polygon
    domains: [equity_ohlcv]
  - name: ivolatility
    domains: [equity_ohlcv]
  - name: iex
    domains: [equity_ohlcv]
  - name: occ
    domains: [option_contract_reference, option_contract_ohlcv, option_open_interest]
  - name: opra
    domains: [option_contract_reference, option_contract_ohlcv, option_open_interest]
  - name: factset
    domains: [fundamentals]
  - name: sec
    domains: [fundamentals]
  - name: financialdatasets
    domains:
      [
        fundamentals,
        financial_statements,
        company_facts,
        financial_metrics,
        financial_metrics_snapshot,
        insider_trades,
        institutional_ownership,
        news,
      ]
    raw_storage_policy:
      company_facts:
        policy: snapshot_single_csv
        dedup_keys: [ticker]
      financial_metrics:
        policy: snapshot_table_csv
        date_priority: [report_period, as_of_date]
        date_kind: date
        dedup_keys: [ticker]
      financial_metrics_snapshot:
        policy: snapshot_table_csv
        date_priority: [report_period, as_of_date]
        date_kind: date
        dedup_keys: [ticker]
      financial_statements:
        policy: timeseries_csv_unsharded
        date_priority: [report_date]
        date_kind: date
        dedup_keys: [ticker, report_date, statement_type]
      institutional_ownership:
        policy: timeseries_csv_unsharded
        date_priority: [report_period]
        date_kind: date
        dedup_keys: [ticker, report_period, investor]
      news:
        policy: timeseries_csv_unsharded
        date_priority: [published_at, date]
        date_kind: datetime
        dedup_keys: [ticker, published_at, date, title, url]
      insider_trades:
        policy: timeseries_csv_yearly
        date_priority: [filing_date]
        date_kind: date
        dedup_keys: [ticker, filing_date, name, transaction_date, transaction_value, transaction_shares, security_title]

reconciliation:
  allowed_validation_statuses: ["passed"]
  domains:
    equity_ohlcv:
      vendor_priority: [polygon, ivolatility, iex]
      fallback_mode: per_symbol
    option_contract_reference:
      vendor_priority: [occ, opra]
      enforce_single_vendor_per_underlying: true
      allow_fallback: true
    option_contract_ohlcv:
      vendor_priority: [occ, opra]
      enforce_single_vendor_per_underlying: true
      allow_fallback: true
    option_open_interest:
      vendor_priority: [occ, opra]
      enforce_single_vendor_per_underlying: true
      allow_fallback: true
    fundamentals:
      vendor_priority: [factset, sec, financialdatasets]
      fundamentals_of_record: factset
      allow_fallback: true
    insiders:
      vendor_priority: [financialdatasets]
